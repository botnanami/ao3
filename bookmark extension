(function() {
    'use strict';

const NOTES_APPEND_TO_PREVIOUS = false;

 const ADD_URL_AND_USERNAME = true;

 const PRIVATE_DEFAULT = true;

const PRIVATE_DEFAULT_SERIES = true;

 var url = window.location.href;
    if(url.includes("/works/"))
    {
        Bookmarks4Works(url);
    }
    else if(url.includes("/series/"))
    {
        Bookmarks4Series(url);
    }
 
    function Bookmarks4Works(url)
    {
        url = window.location.href;
        var notesBoxText = "";
        var notesBox = document.getElementById("bookmark_notes");
 
        if(ADD_URL_AND_USERNAME)
        {
 
            var title = document.getElementsByClassName("title heading");
            var userName = document.getElementsByClassName("byline heading");
            userName = userName[0];
            title = title[0];
            if(userName.textContent.includes("("))
            {
                var pseud = userName.textContent.split("(");
                userName = pseud[1].trim();
                pseud = pseud[0].trim();
                userName = userName.substring(0, userName.length-1);
                notesBoxText = "<a href=\"" + url + "\">" + title.textContent.trim() + "</a> by <a href=\"/users/" + userName + "/pseuds/" + pseud + "\"> (" + pseud + ") " + userName + "</a>";
 
            }
            else
            {
                userName = userName.textContent.trim();
                notesBoxText = "<a href=\"" + url + "\">" + title.textContent.trim() + "</a> by <a href=\"/users/" + userName + "/pseuds/" + userName + "\">" + userName + "</a>";
            }
        }

         if(PRIVATE_DEFAULT)
        {
            var privateBox = document.getElementById("bookmark_private");
            privateBox.checked = true;
        }

         if(NOTES_APPEND_TO_PREVIOUS)
        {
            if(notesBox)
            {
                notesBox.value = notesBox.value + "\n" + notesBoxText;
            }
        }
        else
        {
            if(notesBox)
            {
                notesBox.value = notesBoxText;
            }
        }
 
        return ;
    }

      function Bookmarks4Series(url)
    {
        var notesBox = document.getElementById("bookmark_notes");
        var notesBoxText = "";
        var statsPanel = document.getElementsByClassName("series meta group")[0]
        var tagBox = document.getElementById("bookmark_tag_string_autocomplete");
        if(ADD_SERIES_URL_AND_USERNAME)
        {
 
            var seriesTitle = document.getElementsByTagName("h2");
 
            var userNames = statsPanel.querySelectorAll('[rel="author"]')
 
 
            seriesTitle = seriesTitle[0];
            if(notesBox)
            {
                for(var i = 0; i < userNames.length; i++)
                {
                    if(userNames[i].textContent.includes("("))
                    {
                        var pseud = userNames[i].textContent.split("(");
                        var username = pseud[1].trim();
                        pseud = pseud[0].trim();
                        username = username.substring(0, username.length-1);
                        username = "<a href=\"/users/" + username + "/pseuds/" + pseud + "\"> (" + pseud + ") " + username + "</a>";
                    }
                    else
                    {
                        var username = userNames[i].textContent.trim();
                        username ="<a href=\"/users/" + username + "/pseuds/" + username + "\">" + username + "</a>";
                    }
                    if(i == 0)
                    {
                        notesBoxText = "<a href=\"" + url + "\">" + seriesTitle.textContent.trim() + "</a> by " + username;
                    }
                    else
                    {
                        notesBoxText = notesBoxText + " & " + username;
                    }
                }
 
            }
 
        }
          if(PRIVATE_DEFAULT_SERIES)
        {
            var privateBox = document.getElementById("bookmark_private");
            privateBox.checked = true;
        }
 
        if(NOTES_APPEND_TO_PREVIOUS)
        {
            if(notesBox)
            {
                notesBox.value = notesBox.value + "\n" + notesBoxText;
            }
        }
        else
        {
            if(notesBox)
            {
                notesBox.value = notesBoxText;
            }
        }
 
    }


    }
 
)();
